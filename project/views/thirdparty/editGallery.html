<!DOCTYPE html>
<html lang="en">
<head>
    <title>好云商-后台管理</title>
    @@include("shared/global-meta.html")
    <!-- 引入全局样式 -->
    <!-- 全局样式 -->
    @@include("shared/global-import-css.html")
    <!-- 引入全局插件样式 -->
    <!-- 全局插件样式 -->
    @@include("shared/global-import-plugins-css.html")
    <!-- 全局主题样式 -->
    <link rel="stylesheet" href="../../plugin/pager/css/pager.css">
    <link rel="stylesheet" href="../../plugin/cropper/cropper.min.css">
    <link rel="stylesheet" href="../../css/bulidingCity/managementApp.css">
    <link rel="stylesheet" href="../../plugin/select/select.css">
    <style>

        #biaoQian .isClose{
            display: inline-block;
            border:1px solid #666;
            padding: 3px 6px;
            position: relative;
            margin:0 0 0 10px;
        }
        #biaoQian .isClose b{
            font-weight:normal;
        }
        #biaoQian .isClose i{
            font-style:normal;
            position: absolute;
            display:block;
            color:#fff;
            background-color:rgb(216,74,80);
            border-radius: 100%;
            width: 20px;
            height: 20px;
            top:-10px;
            right: -10px;
            text-align: center;
            line-height: 20px;
            cursor: pointer;
        }
    </style>
</head>
<body class="page-header-fixed page-sidebar-closed-hide-logo page-content-white">
<div class="page-wrapper">
    <!-- 顶部Bar开始 -->
    @@include("shared/header.html")
    <!-- 顶部Bar结束 -->
    <div class="clearfix"></div>
    <!-- 页面中间部分内容开始 -->
    <div class="page-container">
        <!-- 侧边栏开始 -->
        @@include("shared/thirdPartysliderbar.html")
        <!-- 侧边栏结束 -->
        <!-- 页面主内容开始 -->
        <div class="page-content-wrapper">
            <div class="page-content">
                <div class="page-bar no-border">
                    <h1 class="page-title bold">编辑全景展厅</h1>
                </div>
                <!-- 活动查询框结束 -->
                <div class="row">
                    <div class="col-md-12">
                        <!-- 表格开始-->
                        <div id="Header" class="portlet light bordered" style="padding-bottom:30px;">
                            <div class="portlet-body">
                                <div id="queryPage">
                                    <h3>编辑全景展厅</h3>
                                    <form id="galleryContainer">
                                        <div class="form-group brand-msg" id="icon">
                                           <span class="width">
                                               <span class="required" aria-required="true"> *&nbsp;</span>
                                               <span class="span-label no-required">封面图：</span>
                                           </span>
                                            <div class="logo-img-wrapper" style="display: inline-block;">
                                                <input type="hidden" class="inputImg" name="img">
                                                <i class="brand-logo-img icon iconfont icon-add imgIcon1"
                                                   style="position: absolute; border: none; top: 48px; left: 195px;"></i>
                                                <img class="brand-logo-img bigImg coverImg" alt=""
                                                     style="display: inline-block;width: 400px;height: 200px;">
                                                <span class="prompt"></span>
                                            </div>
                                            <div id="canvas" class="canvasCss"
                                                 style="display: none;left: 250px;top: 40px;border:none;">
                                                <canvas id="myCanvas" width="118px" height="118px">
                                                    您的浏览器不支持canvas标签。
                                                </canvas>
                                                <span class="percent"></span>
                                            </div>
                                        </div>
                                        <div class="form-group brand-msg" id="icon1">
                                           <span class="width">
                                                <span class="required" aria-required="true"> *&nbsp;</span>
                                                <span class="span-label no-required">全景图：</span>
                                           </span>
                                            <div class="logo-img-wrapper" style="display: inline-block;">
                                                <input type="hidden" class="inputImg1" name="img">
                                                <i class="brand-logo-img1 icon iconfont icon-add imgIcon1"
                                                   style="position: absolute; border: none; top: 48px; left: 195px;"></i>
                                                <img class="brand-logo-img1 panoImg" alt=""
                                                     style="display: inline-block;width: 400px;height: 200px;">
                                                <span class="prompt"></span>
                                            </div>
                                            <div id="canvas1" class="canvasCss"
                                                 style="display: none;left: 250px;top: 40px;border:none;">
                                                <canvas id="myCanvas1" width="118px" height="118px">
                                                    您的浏览器不支持canvas标签。
                                                </canvas>
                                                <span class="percent"></span>
                                            </div>
                                        </div>
                                        <div class="form-group brand-msg">
                                            <span class="width">
                                                <span class="required" aria-required="true"> *&nbsp;</span>
                                                <span class="span-label no-required">选择标签：</span>
                                            </span>
                                            <button id="chooseTags" class="btn gray btn-outline" data-toggle="modal"
                                                    type="button" href="#selectTag">选择标签
                                            </button>
                                            <div id="biaoQian" style="display:inline-block;">

                                            </div>
                                            <span class="red Verification5">请选择标签</span>
                                        </div>
                                        <div class="form-group brand-msg">
                                            <span class="span-label no-required width">&nbsp;&nbsp;&nbsp;全景标题：</span>
                                            <input class="form-control input-sm isWidth" id="title" name="title" maxlength="30" placeholder="请输入全景标题,最多输入30字">
                                        </div>
                                        <div class="form-group brand-msg">
                                            <span class="span-label no-required width">备注：</span>
                                            <textarea class="form-control input-sm isWidth" id="remark" rows="5" cols="50"></textarea>
                                        </div>
                                    </form>
                                    <div class="portlet-title operation" style="padding-top: 60px;">
                                        <a type="button" class="btn dark btn-outline" id="back"
                                           style="margin: 0 20px 0 364px;">返回</a>
                                        <a type="button" class="btn green toggle-disabled" id="add">保存</a>
                                        <a type="button" class="btn green" id="iconEdit">保存</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- 表格结束 -->
                    </div>
                </div>
            </div>
        </div>
        <!-- 页面主内容结束 -->
    </div>
    <!-- 页面中间内容部分结束 -->
    <!-- 页脚开始 -->
    @@include("shared/footer.html")
    <!-- 页脚结束 -->
</div>
<!--选择标签-->
<div class="modal fade bs-modal-lg" id="selectTag" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title bold">选择标签</h4>
            </div>
            <div class="modal-body" style="min-height:400px;_height:400px;max-height:500px;overflow: auto;">
                <div style="border:1px dotted #ccc;padding:10px;">
                    <button type="button" class="btn green btn-outline pull-left" id="select" style="margin-right: 20px;">全选</button>
                    <button type="button" class="btn green btn-outline pull-left" id="noSelect" style="margin-right: 20px;">取消全选</button>
                    <button type="button" class="btn dark btn-outline confirm" data-toggle="modal"  href="#confirmModal2" disabled>确认选择</button>
                </div>
                <div class="portlet-body">
                    <table class="table table-striped table-bordered table-hover table-header-fixed" id="sample">
                        <thead>
                        <tr class="table-header">
                            <th>#</th>
                            <th>标签名称</th>
                        </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                    <div class="row" style="position: absolute;bottom:0;right: 30px;">
                    <span id="pager2" class="pager pull-right">
                    </span>
                    </div>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
</div>
<!--选择标签内容-->
<script type="text/html" id="isContainer">
    {{each tagsList as value i}}
    <tr>
        <td>
            <label class="mt-checkbox mt-checkbox-outline">
                <input data-id="{{value.id}}" type="checkbox" value="1">
                <span></span>
            </label>
        </td>
        <td>{{value.name}}</td>
    </tr>
    {{/each}}
</script>
<!--是否删除弹窗-->
<div class="modal fade bs-modal-sm" id="confirmModal1" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-body"> 确定删除吗？</div>
            <div class="modal-footer no-border">
                <button type="button" class="btn dark confirmDelete" data-dismiss="modal" data-func="confirmDelete">确定
                </button>
                <button type="button" class="btn dark btn-outline" data-dismiss="modal">取消</button>
            </div>
        </div>
    </div>
</div>
<!--确定选择标签-->
<div class="modal fade bs-modal-sm" id="confirmModal2" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-body"> 确定选择吗？ </div>
            <div class="modal-footer no-border">
                <button type="button" class="btn green confirmChoose2">确定</button>
                <button type="button" class="btn dark btn-outline deleteCancel" data-dismiss="modal">取消</button>
            </div>
        </div>
    </div>
</div>
<!-- 页面内容结束 -->
<!-- 载入全局依赖js -->
<script src="../../assets/global/plugins/jquery.min.js" type="text/javascript"></script>
<script src="../../assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../../assets/global/scripts/app.min.js" type="text/javascript"></script>
<script src="../../assets/global/plugins/js.cookie.min.js" type="text/javascript"></script>
<script src="../../assets/layouts/layout/scripts/layout.min.js" type="text/javascript"></script>
<script src="../../plugin/artTemplate/template.js"></script>
<script src="../../plugin/draggabilly/draggabilly.pkgd.min.js"></script>
<script src="../../js/config.js"></script>
<script src="../../js/utils.js"></script>
<script src="../../js/jquery.extend.js"></script>
<script src="../../plugin/toastr/toastr.js"></script>
<script src="../../plugin/jquery-validate/jquery.validate.js"></script>
<script src="../../js/common.js"></script>

<!-- 本页面依赖组件初始化 -->
<script src="../../plugin/pager/jquery-pager.js"></script>
<script src="../../js/renovationImg/renovationImgList.js"></script>
<!-- 上传图片脚本 -->
<script src="../../plugin/qCloud/cos-js-sdk-v4.js"></script>
<script src="../../plugin/qCloud/crypto.js"></script>
<script src="../../plugin/qCloud/qCloud.js"></script>
<script src="../../plugin/upload/cropper.js"></script>
<script src="../../plugin/upload/qcloud-cropper.js"></script>
<script src="../../js/panoramaHall/editGallery.js"></script>
<script>
    //页面页码模块
    var editGallery = new EditGallery();
    editGallery.create();
    //封面图
    $(".brand-logo-img").click(function () {
        $.imgUpload({
            callbackEle: "[name='brandImg'],.brand-logo-img",
            successCallback: function (path) {
                $("input[type='file']").css('display', 'none');
                $("#icon").find('i').css('display', "none");
                $('.inputImg').attr("path", path);
            },
            progressCallBack: function (curr) {
                if (curr > 0) {
                    $("#canvas").css('display', 'block');
                    $("#canvas").parent().find('i').css('display', 'none');
                }
                var canvas = document.getElementById("myCanvas");
                if (canvas.getContext) {
                    var ctx = canvas.getContext("2d");
                    ctx.beginPath();
                    ctx.lineWidth = 5;
                    ctx.lineWidth = 5;//线条宽度
                    var circle = {
                        x: 60,    //圆心的x轴坐标值
                        y: 60,    //圆心的y轴坐标值
                        r: 30      //圆的半径
                    };
                    ctx.strokeStyle = '#32c5d2';
                    ctx.arc(circle.x, circle.y, circle.r, 0, 2 * curr * Math.PI, false);
                    ctx.stroke();
                    var percent = (curr.toFixed(2) * 100).toFixed(0);
                    $(".percent").html("" + percent + "%");
                    if (curr == 1) {
                        $("#canvas").css('display', 'none');
                    }
                }
            },
            cropper: false,
            cropperOpts: {
                /*aspectRatio: 1/1,//截图框的比例*/
                zoomable: false, //禁用鼠标滚轮放大缩小
                viewMode: 1 //截图框只能在图片区域内移动
            }
        }, cos)
    });
    //全景图
    $(".brand-logo-img1").click(function () {
        $.imgUpload({
            callbackEle: "[name='brandImg'],.brand-logo-img1",
            successCallback: function (path) {
                $("input[type='file']").css('display', 'none');
                $("#icon1").find('i').css('display', "none");
                $('.inputImg1').attr("path", path);
            },
            progressCallBack: function (curr) {
                if (curr > 0) {
                    $("#canvas1").css('display', 'block');
                    $("#canvas1").parent().find('i').css('display', 'none');
                }
                var canvas = document.getElementById("myCanvas1");
                if (canvas.getContext) {
                    var ctx = canvas.getContext("2d");
                    ctx.beginPath();
                    ctx.lineWidth = 5;
                    ctx.lineWidth = 5;//线条宽度
                    var circle = {
                        x: 60,    //圆心的x轴坐标值
                        y: 60,    //圆心的y轴坐标值
                        r: 30      //圆的半径
                    };
                    ctx.strokeStyle = '#32c5d2';
                    ctx.arc(circle.x, circle.y, circle.r, 0, 2 * curr * Math.PI, false);
                    ctx.stroke();
                    var percent = (curr.toFixed(2) * 100).toFixed(0);
                    $(".percent").html("" + percent + "%");
                    if (curr == 1) {
                        $("#canvas1").css('display', 'none');
                    }
                }
            },
            fixedWidth: 6000,
            fixedHeight: 3000,
            cropper: false,
            cropperOpts: {
                aspectRatio: 2 / 1,//截图框的比例*/
            }
        }, cos)
    })
    $("#galleryContainer").validate({
        rules: {
            logo: "required",
            name: "required",
            userName: "required",
            password: "required",
            otype: "1"
        },
        ignore: "",
        messages: {
            logo: "logo必须上传",
            name: "第三方名称必须填写",
            userName: "登录账号必须填写",
            password: "登录密码必须填写"
        },
        submitHandler: function () {
            if ($("#galleryContainer").valid()) {
                /*  var obj= $("#addForm").serializeObject();
                 loader.save(obj,function(result){
                 if(result.statusCode==0){
                 $("#addAccount").modal("hide");
                 $("#btnQuery").trigger("click");
                 }else{
                 toastr.error(result.errorMsg);
                 }

                 })*/
            }
            return false;
        }

    });


</script>
</body>

</html>
